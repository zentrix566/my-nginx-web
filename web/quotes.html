<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>每日随记 | 语录卡片</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --accent-color: #f093fb;
            --text-color: #2c3e50;
        }

        body {
            /* 修改1：允许纵向滚动 */
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            font-family: "Optima", "PingFang SC", "Microsoft YaHei", sans-serif;
            color: var(--text-color);
            overflow-x: hidden;
            overflow-y: auto; 
            position: relative;
            padding: 40px 20px; /* 增加上下留白 */
        }

        /* 粒子画布 */
        #particles-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        .bg-glow {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.3;
            animation: float 20s ease-in-out infinite;
            z-index: 0;
        }

        .bg-glow-1 { width: 600px; height: 600px; background: var(--primary-color); top: -200px; left: -200px; }
        .bg-glow-2 { width: 500px; height: 500px; background: var(--secondary-color); bottom: -150px; right: -150px; animation-delay: -7s; }
        .bg-glow-3 { width: 400px; height: 400px; background: var(--accent-color); top: 50%; left: 50%; transform: translate(-50%, -50%); animation-delay: -14s; }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(-30px, 30px) scale(0.95); }
        }

        #quote-container {
            width: 100%;
            max-width: 720px;
            padding: 60px 50px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 24px;
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            text-align: center;
            position: relative;
            z-index: 1;
            margin: auto; /* 居中 */
        }

        .quote-mark {
            position: absolute;
            font-size: 8rem;
            font-family: "Georgia", serif;
            opacity: 0.08;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            z-index: -1;
        }

        .quote-mark-left { top: -30px; left: 20px; transform: rotate(-5deg); }
        .quote-mark-right { bottom: -50px; right: 20px; transform: rotate(180deg) scaleX(-1); }

        #content {
            /* 修改2：优化长文本排版 */
            font-size: 1.35rem;
            line-height: 1.8;
            margin-bottom: 25px;
            font-weight: 400;
            display: block;
            text-align: justify; /* 两端对齐更整齐 */
            color: #e8e8e8;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            opacity: 1;
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            letter-spacing: 0.05em;
        }

        #author {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.5);
            margin-top: 15px;
            text-align: right;
            font-style: italic;
        }

        .divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            margin: 30px 0;
        }

        #btn-refresh {
            margin-top: 10px;
            padding: 16px 45px;
            border: none;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 50px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.4s;
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.35);
            letter-spacing: 0.15em;
        }

        #btn-refresh:hover { transform: translateY(-3px); box-shadow: 0 12px 35px rgba(102, 126, 234, 0.5); }
        #btn-refresh:active { transform: translateY(-1px); }

        @media (max-width: 768px) {
            #quote-container { padding: 40px 25px; }
            #content { font-size: 1.15rem; line-height: 1.7; }
            .quote-mark { font-size: 5rem; }
        }
    </style>
</head>
<body>

<canvas id="particles-canvas"></canvas>
<div class="bg-glow bg-glow-1"></div>
<div class="bg-glow bg-glow-2"></div>
<div class="bg-glow bg-glow-3"></div>

<div id="quote-container">
    <span class="quote-mark quote-mark-left">"</span>
    <span class="quote-mark quote-mark-right">"</span>
    <div id="content">正在拨动命运的齿轮...</div>
    <div class="divider"></div>
    <div id="author"></div>
    <button id="btn-refresh" onclick="fetchQuote()">再换一句</button>
</div>

<script>
    // 粒子背景逻辑保持不变...
    const canvas = document.getElementById('particles-canvas');
    const ctx = canvas.getContext('2d');
    let particles = [];
    function resizeCanvas() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    class Particle {
        constructor() { this.reset(); }
        reset() {
            this.x = Math.random() * canvas.width;
            this.y = Math.random() * canvas.height;
            this.size = Math.random() * 2 + 0.5;
            this.speedX = (Math.random() - 0.5) * 0.5;
            this.speedY = (Math.random() - 0.5) * 0.5;
            this.opacity = Math.random() * 0.5 + 0.1;
        }
        update() {
            this.x += this.speedX; this.y += this.speedY;
            if (this.x < 0 || this.x > canvas.width || this.y < 0 || this.y > canvas.height) this.reset();
        }
        draw() {
            ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            ctx.fillStyle = `rgba(255, 255, 255, ${this.opacity})`; ctx.fill();
        }
    }
    function initParticles() {
        particles = [];
        const count = Math.min(80, Math.floor((canvas.width * canvas.height) / 20000));
        for (let i = 0; i < count; i++) particles.push(new Particle());
    }
    function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        particles.forEach(p => { p.update(); p.draw(); });
        requestAnimationFrame(animate);
    }
    window.addEventListener('resize', () => { resizeCanvas(); initParticles(); });
    resizeCanvas(); initParticles(); animate();

    // 修改后的获取语录逻辑
    async function fetchQuote() {
        const contentEl = document.getElementById('content');
        const authorEl = document.getElementById('author');
        const btn = document.getElementById('btn-refresh');

        contentEl.style.opacity = 0;
        btn.disabled = true;

        try {
            // 这里替换为你真实的API
            const response = await fetch('/api/quotes/random');
            const data = await response.json();

            setTimeout(() => {
                let rawText = data.content;
                
                // 修改3：增加长短句智能排版逻辑
                if (rawText.length > 80) {
                    // 长文本：保持段落感，不强制换行
                    contentEl.innerHTML = rawText.replace(/\n/g, '<br>');
                    contentEl.style.textAlign = "left";
                } else {
                    // 短文本：保持原有的精美断句
                    contentEl.innerHTML = rawText
                        .replace(/([：；。！？])\s*/g, '$1<br>')
                        .replace(/(.{12,})([，])\s*/g, '$1$2<br>');
                    contentEl.style.textAlign = "center";
                }

                authorEl.innerText = data.author ? `—— ${data.author}` : "—— 佚名";
                contentEl.style.opacity = 1;
                btn.disabled = false;
            }, 400);

        } catch (error) {
            // 模拟数据展示（演示用）
            const demo = "最近看到一个“金钱年龄通胀”理论:越年轻时花的钱，性价比越高，30岁消费10000元的快乐，不及10岁时花的1000元。相同金额的钱，会随年龄增长不断稀释其兑换快乐与满足感的能力...（此处省略）";
            contentEl.innerHTML = demo;
            contentEl.style.opacity = 1;
            btn.disabled = false;
        }
    }

    window.onload = fetchQuote;
</script>
</body>
</html>